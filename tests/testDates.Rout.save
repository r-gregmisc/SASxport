
R version 4.0.3 (2020-10-10) -- "Bunny-Wunnies Freak Out"
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin17.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(SASxport)
> Sys.setenv("TZ"="GMT")
> 
> ## Create a small data set containing dates, times, and date-times
> 
> dates <- c("02/27/92", "02/27/92", "01/14/92", "02/28/92", "02/01/92")
> times <- c("23:03:20", "22:29:56", "01:03:30", "18:21:03", "16:56:26")
> 
> 
> temp <- data.frame(
+   x=c(1L, 2L, 3L, 4L, 5L), # integer
+   z=c(1.1, 2.2, 3.3, 4.4, 5.5), # real
+   y=c('a', 'B', 'c', 'd', 'e' ),
+   date=as.Date(dates, format="%m/%d/%y"),
+   datetime=strptime( paste(dates,times), "%m/%d/%y %H:%M:%S"),
+   stringsAsFactors = FALSE
+ )
> 
> print(temp)
  x   z y       date            datetime
1 1 1.1 a 1992-02-27 1992-02-27 23:03:20
2 2 2.2 B 1992-02-27 1992-02-27 22:29:56
3 3 3.3 c 1992-01-14 1992-01-14 01:03:30
4 4 4.4 d 1992-02-28 1992-02-28 18:21:03
5 5 5.5 e 1992-02-01 1992-02-01 16:56:26
> 
> write.xport( DATETIME=temp, file="datetime.xpt")
> temp2 <- read.xport(file="datetime.xpt",
+                     names.tolower=TRUE,
+                     verbose = TRUE)
### Checking if the specified file has the appropriate header ###
### Extracting data file information... ###
### Reading the data file... ###
### Processing contents... ###
### Processing SAS dataset DATETIME ###
### . ###
### . ###
### Done ###
> 
> print(temp2)
  x   z y       date            datetime
1 1 1.1 a 1992-02-27 1992-02-27 23:03:20
2 2 2.2 B 1992-02-27 1992-02-27 22:29:56
3 3 3.3 c 1992-01-14 1992-01-14 01:03:30
4 4 4.4 d 1992-02-28 1992-02-28 18:21:03
5 5 5.5 e 1992-02-01 1992-02-01 16:56:26
> 
> # Strip off SASformats added by read.xport so comparison won't fail
> for(col in colnames(temp2))
+   SASformat(temp2[[col]]) <- NULL
> 
> identical(temp, temp2)
[1] TRUE
> 
> # Test for issue #19: toSAS() - The number of seconds since
> # 1960-01-01:00:00:00 GMT is greater than it is supposed to be
> 
> zeroDate <- ISOdate(1960, 01, 01, 00, 00, 00, tz="GMT")
> zeroSAS <- toSAS(zeroDate, format="DATETIME19.")
> 
> stopifnot(zeroSAS==0)
> 
> 
> proc.time()
   user  system elapsed 
  1.697   0.230   1.984 
